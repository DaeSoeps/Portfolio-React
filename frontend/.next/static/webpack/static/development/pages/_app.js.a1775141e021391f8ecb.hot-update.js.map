{"version":3,"file":"static/webpack/static\\development\\pages\\_app.js.a1775141e021391f8ecb.hot-update.js","sources":["webpack:///./pages/signup.js","webpack:///./sagas/user.js"],"sourcesContent":["import React, { useState, useCallback, useEffect } from \"react\";\r\nimport { Form, Input, Checkbox, Button } from \"antd\";\r\nimport { SIGN_UP_REQUEST , isSigningUp } from \"../reducers/user\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport Router from 'next/router';\r\n// Coustom hook 훅에 기능을 추가해서 새로 만듬 ( 중복방지 등 )\r\n// useState(hook) 는 커스텀 훅 제외한 곳에서 사용하지 않기\r\nexport const userInput = (initValue = null) => {\r\n  const [value, setter] = useState(initValue);\r\n  const handler = useCallback(e => {\r\n    setter(e.target.value);\r\n  }, []);\r\n  return [value, handler];\r\n};\r\n\r\n////////////////////////////////\r\n\r\nconst Signup = () => {\r\n  const [id, setId] = useState(\"\");\r\n  const [nick, setNick] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [passwordCheck, setPasswordCheck] = useState(\"\");\r\n  const [term, setTerm] = useState(false);\r\n  const [passwrodError, setpasswordError] = useState(false);\r\n  const [termError, setTermError] = useState(false);\r\n  const dispatch = useDispatch()\r\n  const { isSigningUp, me } = useSelector(state =>state.user)\r\n\r\n  useEffect(()=>{\r\n    if(me){\r\n      alert('로그인 성공');\r\n      Router.push('/');\r\n    }\r\n  },[me && me.id])\r\n  const onSubmit = useCallback(\r\n    e => {\r\n      e.preventDefault();\r\n      console.log({\r\n        id,\r\n        nick,\r\n        password,\r\n        passwordCheck,\r\n        term\r\n      });\r\n      if (password !== passwordCheck) {\r\n        return setpasswordError(true);\r\n      }\r\n      if (!term) {\r\n        return setTermError(true);\r\n      }\r\n      return dispatch({\r\n        type: SIGN_UP_REQUEST,\r\n        data:{\r\n        userId: id,\r\n        password,\r\n        nickname: nick,\r\n        },\r\n      });\r\n    }, [password, passwordCheck, term]\r\n  );\r\n  const onChangeId = e => {\r\n    setId(e.target.value);\r\n  };\r\n  const onChangeNick = e => {\r\n    setNick(e.target.value);\r\n  };\r\n  const onChangePassword = e => {\r\n    setPassword(e.target.value);\r\n  };\r\n  const onChangePasswordChk = useCallback(\r\n    e => {\r\n      setpasswordError(e.target.value !== password);\r\n      setPasswordCheck(e.target.value);\r\n    },\r\n    [password]\r\n  );\r\n  const onChangeTerm = useCallback(e => {\r\n    setTermError(false);\r\n    setTerm(e.target.checked);\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <Form onSubmit={onSubmit} style={{ padding: 10 }}>\r\n        <div>\r\n          <label htmlFor=\"user-id\">아이디</label>\r\n          <br />\r\n          <Input\r\n            name=\"user-id\"\r\n            required\r\n            value={id}\r\n            onChange={onChangeId}\r\n          ></Input>\r\n        </div>\r\n\r\n        <div>\r\n          <label htmlFor=\"user-nick\">닉네임</label>\r\n          <Input\r\n            name=\"user-nick\"\r\n            required\r\n            value={nick}\r\n            onChange={onChangeNick}\r\n          ></Input>\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"user-pass\">비밀번호</label>\r\n          <br />\r\n\r\n          <Input\r\n            name=\"user-pass\"\r\n            type=\"password\"\r\n            required\r\n            value={password}\r\n            onChange={onChangePassword}\r\n          ></Input>\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"user-pass-chk\">비밀번호 체크</label>\r\n          <br />\r\n\r\n          <Input\r\n            name=\"user-pass-chk\"\r\n            type=\"password\"\r\n            required\r\n            value={passwordCheck}\r\n            onChange={onChangePasswordChk}\r\n          ></Input>\r\n          {passwrodError && (\r\n            <div style={{ color: \"red\" }}> 비밀번호가 일치하지 않습니다.</div>\r\n          )}\r\n        </div>\r\n        <div>\r\n          <Checkbox name=\"user-term\" value={term} onChange={onChangeTerm}>\r\n            동의합니다.\r\n          </Checkbox>\r\n          {termError && (\r\n            <div style={{ color: \"red\" }}> 약관에 동의 해주세요.</div>\r\n          )}\r\n        </div>\r\n        <div>\r\n          <div style={{ marginTop: 10 }}></div>\r\n          <Button type=\"primary\" htmlType=\"submit\" loading={isSigningUp}>\r\n            가입하기\r\n          </Button>\r\n        </div>\r\n      </Form>\r\n    </>\r\n  );\r\n};\r\nexport default Signup;\r\n","import { all, fork, takeLatest, takeEvery, call, put, take, delay } from 'redux-saga/effects';\r\nimport { LOG_IN_REQUEST, LOG_IN_SUCCESS, LOG_IN_FAILURE, SIGN_UP_REQUEST, SIGN_UP_SUCCESS, SIGN_UP_FAILURE, signUpAction } from '../reducers/user';\r\nimport axios from 'axios';\r\nimport { func } from 'prop-types';\r\n\r\n\r\nfunction loginAPI(){\r\n// (3) 서버에 요청을 보냄\r\n    return axios.post('/login')\r\n}\r\nfunction signUpAPI(signUpData){\r\n    return axios.post('http://localhost:3065/api/user/', signUpData);\r\n}\r\n    \r\nfunction* login(){ \r\n    // 사가 패턴 3. 어떤 동작할지 결정\r\n    try{\r\n        // yield call(loginAPI); // (2)loginAPI 로 요청을 보냄\r\n        yield delay(2000);\r\n        yield put({ \r\n            type:LOG_IN_SUCCESS\r\n        }); // (4)put은 dispatch와 동일, call이 성공하면 LOG_IN_SUCCESS 실행\r\n    }catch(e){\r\n        console.error(e);\r\n        yield put({\r\n            type:LOG_IN_FAILURE\r\n        })\r\n    }\r\n}\r\nfunction* signUp(action){ \r\n    \r\n    try{\r\n        yield call(signUpAPI , action.data); // 두번째는 첫번째의(함수) 인자값\r\n        yield put({ \r\n            type:SIGN_UP_SUCCESS\r\n        });\r\n    }catch(e){\r\n        console.error(e);\r\n        yield put({\r\n            type:SIGN_UP_FAILURE,\r\n            error: e\r\n        })\r\n    }\r\n}\r\n\r\nfunction* watchLogin(){\r\n    // 사가 패턴 2. takeEvery, Latest 여부 결정\r\n    //takeEvery : while 대체제, watch 에서 take 부분과 실행부분을 나눌때 사용\r\n    //takeLatest : 같은 액션 여러번 호출되도 마지막 액션만 실행(이전 요청이 끝나지 않았으면 이전 요청 취소)\r\n    // yield takeLatest(LOG_IN, login); // (1)LOG_IN 액션을 기다림\r\n    yield takeEvery(LOG_IN_REQUEST, login);\r\n}\r\nfunction* watchSignUp(){\r\n    yield takeEvery(SIGN_UP_REQUEST, signUp)\r\n}\r\n \r\nexport default function* userSaga() {\r\n    // 사가 패턴 1. 함수 등록\r\n    // fork, call : 함수 호출, fork는 비동기 호출\r\n    yield all([\r\n        fork(watchLogin),\r\n        fork(watchSignUp),\r\n    ])\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAMA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAFA;AAQA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAGA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AAAA;;;;;;;;;;;;ACrJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AAAA;;;;A","sourceRoot":""}